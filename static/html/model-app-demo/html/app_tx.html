<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Cache-control" content="no-cache"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  <meta name="format-detection" content="telephone=no"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-title" content="阿拉宁波网"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
  <meta name="keywords" content="宁波,北仑,镇海,阿拉宁波网,新北仑论坛,镇海论坛,宁波网,宁波论坛,房产,人才,二手,商城,团购,文学,博客,摄影,时尚,拼客"/>
  <meta name="description" content="CNNB.COM,阿拉宁波网旗下地方社区门户,提供和分享宁波论坛,北仑论坛,镇海论坛,社交,房产,人才,购物等生活,商务资讯互动平台. ,阿拉宁波网"/>
  <link rel="shortcut icon" href="/favicon.ico"/>
  <link rel="bookmark" href="/favicon.ico" type="image/x-icon"/>
  <base href="http://dev.bbs.cnnb.com/"/>
  <title>提现 - 阿拉宁波网 - 手机版</title>
  <link rel="stylesheet" href="http://dev.bbs.cnnb.com/source/plugin/duceapp_base/static/css/base.css" type="text/css"
        media="all">
  <link id="duceapp_style" rel="stylesheet"
        href="http://dev.bbs.cnnb.com/source/plugin/duceapp_base/static/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="http://dev.bbs.cnnb.com/data/duceapp/base/common.css?FKK" type="text/css" media="all">
  <link rel="stylesheet" href="source/plugin/duceapp_scorebuy/static/css/addfunds_mobile.css?FKK" type="text/css"
        media="all">
  <script src="http://dev.bbs.cnnb.com/source/plugin/duceapp_base/static/js/jquery.min.js?FKK"
          type="text/javascript"></script>
  <script type="text/javascript">var STYLEID = '14', STATICURL = 'static/',
      IMGDIR = 'http://dev.bbs.cnnb.com/template/weixia_cms/weixia/src/', VERHASH = 'FKK', charset = 'utf-8',
      discuz_uid = '8', cookiepre = 'oYZ9_f4b9_', cookiedomain = '.dev.bbs.cnnb.com', cookiepath = '/',
      showusercard = '1', attackevasive = '0', disallowfloat = 'newthread', creditnotice = '1|威望|,2|财富|,7|甬钻|',
      defaultstyle = '',
      REPORTURL = 'aHR0cDovL2Rldi5iYnMuY25uYi5jb20vcGx1Z2luLnBocD9pZD1kdWNlYXBwX3Njb3JlYnV5OnRyYWRlbG9nJm1vYmlsZT0y',
      SITEURL = 'http://dev.bbs.cnnb.com/', JSPATH = 'data/cache/', DUCEAPP = {}, calendarform = {
          head: '日期时间设置',
          year: ['年', 2000, 2030],
          month: ['月', 1, 12],
          day: ['日', 1, 28],
          hour: ['时', 0, 23],
          minute: ['分', 0, 59]
      }, DUCEAPP_LANG = {confirms: '确定', cancel: '取消'}, DUCEAPP_BASE = 'duceapp_base';</script>
  <script src="http://dev.bbs.cnnb.com/source/plugin/duceapp_base/static/js/common.js?FKK" type="text/javascript"
          charset="utf-8"></script>
  <style>
    html {
      background-color: #FFFFFF;
    }
  </style>
</head>
<body class="bg">
<div class="duceapp_body">
  <div id="duceapp_head">
    <div class="headfixed duceapp_head fff hc">
      <div class="head_z z"><a href="javascript:;" onclick="history.go(-1)"><i class="duceapp_font f22">&#xe95d;</i></a>
      </div>
      <div class="head_y y"><a href="home.php?mod=space&amp;uid=8&amp;do=profile&amp;mycenter=1&amp;mobile=2"><i
        class="duceapp_font f22">&#xe932;</i></a></div>
      <h2>提现记录</h2>
    </div>
  </div>
  <div class="tbbox tbscrl tbbox2">
    <div class="tabs" id="tabs">
      <div class="tab bi_d bga">
        <ul class="f15 tab8 ff9">
          <li>
            <a href="home.php?mod=spacecp&amp;ac=credit&amp;op=base&amp;mobile=2">我的</a>
          </li>
          <li class="bb_d f15">
            <a
              href="home.php?mod=spacecp&amp;ac=plugin&amp;op=credit&amp;id=duceapp_scorebuy:tradelog&amp;mobile=2">记录</a>
          </li>
          <li class="bb_d f15 ">
            <a
              href="home.php?mod=spacecp&amp;ac=plugin&amp;op=credit&amp;id=duceapp_scorebuy:addfunds&amp;mobile=2">充值</a>
          </li>
          <li class="bb_d f15">
            <a
              href="">订单</a>
          </li>
          <li class="bb_d f15 a">
            <a href="home.php?mod=spacecp&amp;ac=plugin&amp;op=credit&amp;id=duceapp_scorebuy:cash&amp;mobile=2">提现</a>
          </li>
          <li class="bb_d f15 ">
            <a
              href="home.php?mod=spacecp&amp;ac=plugin&amp;op=credit&amp;id=duceapp_scorebuy:invoice&amp;mobile=2">发票</a>
          </li>
          <li class="bb_d f15">
            <a
              href="">兑换</a>
          </li>
        </ul>
      </div>
      <div class="tbb bi_d bgb rel">
        <ul class="f14 ffb cl">
          <li class="a"><a href="plugin.php?id=duceapp_scorebuy:tradelog&amp;mobile=1">提现记录</a>
          <li class="b">/</li>
        </ul>
        <span onclick="$('#srchlogfm').show();$(document.body).scrollTop(0)" class="abs mg_r ffr f14"
              style="top:8px;right:0;"><i class="duceapp_font vm2">&#xe951;</i> 提现</span></div>
    </div>
  </div>
  <div id="srchlogfm" class="srchlogfm bga" style="margin-top: -1px;">
    <form method="post" id="cy_form" action="plugin.php?id=duceapp_scorebuy:tradelog">
      <div class="bform tform sjno">
        <ul class="with optinit in65">
          <li>
            <div style="width: 50%; display: inline-block; float: left;">
              <span class="ipp">兑换</span>
              <div class="ipt">
                <input class="px" type="number" id="exchange_num" name="orderid" value=""
                       onkeyup="value = value.replace(/[^\d.]/g, '')"></div>
            </div>
            <div style="width: 50%; display: inline-block; float: left;">
              <span class="ipp"></span>
              <div class="ipt">
                <input id="jewel" value="甬钻" name="paytype" class="ps" readonly/>
              </div>
            </div>
          </li>

          <li>
            <span style="text-align: left; font-size: 12px; white-space: initial; color: #999;">
                合计 <em style="color: red;" id="exchange_money">0</em> 元
              到APP钱包
            </span>

            <span style="float: right; font-size: 12px; white-space: initial; color: #999;" id="show_msg">
              <em style="color: red;">最大提现额度必须大于2000</em>
            </span>
          </li>

          <li>
            <span style="text-align: left; font-size: 12px; white-space: initial; color: #999;">
                总计拥有 <em style="color: red;" id="y_sum">4477</em> 甬钻， 最多可提现
              <em style="color: #19ff35;" id="max_money">3477</em>
              ,合计
              <em style="color: #3589ff;" id="sum_money">3.48</em>
               元RMB，提现后最低余额
              <em style="color: #cbcbcb;" id="min_money">1000</em>
            </span>
          </li>

          <li class="pnfm">
            <div class="w cl">
              <div class="z">
                <button type="button" name="search" class="pn pnw" style="background:#BBB;"
                        onclick="$('#srchlogfm').hide()" value="true">取消
                </button>
              </div>
              <div class="y">
                <button type="submit" name="search" class="pn bgt pnw" id="searchsubmit">提交</button>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </form>
  </div>
  <div class="creditslog">
    <ul class="pagelazy" id="page-ul">
    </ul>
  </div>

</div>
<script src="source/plugin/duceapp_base/static/js/optinit.js?FKK" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
    var ratio = 1000;

    //获取文档高度
    function getDocumentTop() {
        var scrollTop = 0, bodyScrollTop = 0, documentScrollTop = 0;
        if (document.body) {
            bodyScrollTop = document.body.scrollTop;
        }
        if (document.documentElement) {
            documentScrollTop = document.documentElement.scrollTop;
        }
        scrollTop = (bodyScrollTop - documentScrollTop > 0) ? bodyScrollTop : documentScrollTop;
        return scrollTop;
    }

    //可视窗口高度
    function getWindowHeight() {
        var windowHeight = 0;
        if (document.compatMode == "CSS1Compat") {
            windowHeight = document.documentElement.clientHeight;
        } else {
            windowHeight = document.body.clientHeight;
        }
        return windowHeight;
    }

    //滚动条高度
    function getScrollHeight() {
        var scrollHeight = 0, bodyScrollHeight = 0, documentScrollHeight = 0;
        if (document.body) {
            bodyScrollHeight = document.body.scrollHeight;
        }
        if (document.documentElement) {
            documentScrollHeight = document.documentElement.scrollHeight;
        }
        scrollHeight = (bodyScrollHeight - documentScrollHeight > 0) ? bodyScrollHeight : documentScrollHeight;
        return scrollHeight;
    }

    var finished = true;

    $(function () {
        init(); //初始化查询下拉框选项值
        var items = getItems(); //测试数据   可删除
        // var items = getInitData(); //后台请求数据 获取集合
        var pageSize = 5;  //初始化 当页显示总行数
        var totalPage = getItems().length; //请求数据总行数
        appendToHTML(items, pageSize);  //显示数据内容
        $(window).scroll(function () {  //页面滑动至底部更新数据
            if (finished && getScrollHeight() >= (getWindowHeight() + getDocumentTop()) && pageSize <= totalPage) {
                console.log('已滑至底部');
                finished = false;
                // 设置两秒请求后台
                setTimeout(function () {
                    finished = true;
                    pageSize += 5;  //每请求一次增加一页显示
                    appendToHTML(items, pageSize); //更新数据
                    return;
                }, 2000);
            }
            ;
        });

        //查询 数据 异步实时更新显示
        $('#searchsubmit').click(function () {
            // items = ajax_http();
            appendToHTML(items, 5);
        });

        //请求后台数据 仅用于积分记录查询 一下全部为字符串类型
        function ajax_http() {
            var initItems = [];
            var integral = $('#integral').val();
            var starttime = $('#startTime').val();
            var endtime = $('#endTime').val();
            var expenses = $('#expenses').val();
            var operation = $('#operation').val();

            //请求路径及筛选值
            $.ajax({
                //url: "http://localhost:8080/static/data/demo.json?integral="+integral + "&starttime="+starttime +
                // "&endtime="+endtime+"&expenses="+expenses+"&operation="+operation,
                dataType: "json",
                async: true,
                type: "GET", //请求方式
                contentType: "application/json;charset=UTF-8",
                success: function (res) {
                    console.log(JSON.stringify(res));
                    var data_list = res.data;
                    if (res.status == 200) {
                        if (data_list != null && data_list != null && data_list != 'undefined') {
                            initItems = data_list;
                        }
                    } else {
                        console.dir(JSON.stringify(res));
                    }
                },
                error: function (err) {
                    console.log(err);
                }
            });
            return initItems;
        };

        //初始化下拉动态选项值
        function init() {
            var $integral = $('#integral');
            var Integrals = getIntegrals();
            var $expenses = $('#expenses');
            var Expenses = getExpenses();
            var $operation = $('#operation');
            var Operations = getOperations();
            joinToSelect(Integrals, $integral);
            joinToSelect(Expenses, $expenses);
            joinToSelect(Operations, $operation);
        };

        //获取积分下拉集合
        function getIntegrals() {
            var Integrals = [
                {name: '不限', value: '0'},
                {name: '威望', value: '1'},
                {name: '财富', value: '1'},
                {name: '甬钻', value: '1'}
            ];

            $.ajax({
                //url: "http://localhost:8080/static/data/demo.json",  //请求路径
                dataType: "json",
                async: true,
                // data: {"company_name": company_name },
                type: "POST", //请求方式
                contentType: "application/json;charset=UTF-8",
                success: function (res) {
                    var data_list = res.data;
                    if (res.status == 200) {
                        if (data_list != null && data_list != null && data_list != 'undefined') {
                            Integrals = data_list;
                        }
                    } else {

                    }
                },
                error: function (err) {
                    console.log(err);
                }
            });
            return Integrals;
        };

        //获取收支下拉集合
        function getExpenses() {
            var expenses = [
                {name: '不限', value: '0'},
                {name: '支出', value: '1'},
                {name: '支入', value: '2'}
            ];

            $.ajax({
                //url: "http://localhost:8080/static/data/demo.json",  //请求路径
                dataType: "json",
                async: true,
                // data: {"company_name": company_name },
                type: "POST", //请求方式
                contentType: "application/json;charset=UTF-8",
                success: function (res) {
                    var data_list = res.data;
                    if (res.status == 200) {
                        if (data_list != null && data_list != null && data_list != 'undefined') {
                            expenses = data_list;
                        }
                    } else {

                    }
                },
                error: function (err) {
                    console.log(err);
                }
            });
            return expenses;
        };

        //获取操作下拉集合
        function getOperations() {
            var operations = [
                {name: '请选择操作类型', value: '0'},
                {name: '任务奖励', value: '1'},
                {name: '悬赏主题', value: '2'},
                {name: '最佳答案', value: '3'}
            ];

            $.ajax({
                //url: "http://localhost:8080/static/data/demo.json",  //请求路径
                type: "POST", //请求方式
                // data: {"company_name": company_name },
                dataType: "json",
                async: true,
                contentType: "application/json;charset=UTF-8",
                success: function (res) {
                    var data_list = res.data;
                    if (res.status == 200) {
                        if (data_list != null && data_list != null && data_list != 'undefined') {
                            operations = data_list;
                        }
                    } else {

                    }
                },
                error: function (err) {
                    console.log(err);
                }
            });
            return operations;
        };

        function joinToSelect(item, dom) {
            try {
                for (var i = 0; i < item.length; i++) {
                    var info = item[i];
                    dom.append('<option value="' + info.value + '">' + info.name + '</option>');
                }
            } catch (e) {
                console.log(e);
            }
        }

        //获取初始化总参数
        function getInitData() {
            return ajax_http();
        }

        //页面固定显示
        var li_html = '<li class = "bga bh_e f14"><a href = "#">' +
            '<div class = "cl"> <strong class = "status ffr" style = "float: left;">' + '</strong>' +
            ' <span class = "status"><em style = "color: #8b8b8b;" ></em></span></div><dl class = "cl" style="text-align: center; font-size: 14px; color: #a6a6a6;"><p>' +
            '暂无无更多交易记录' + '</p><dt></dt></dl><dl class = "cl mt6"><dd><span class = "status f13 ff9"></span>' + '</dd></dl></a></li>';


        var newHtml = '<li class="bga bh_e f14"><a href="#"><div class="cl"><span class="f13 ff9" style="white-space:nowarp">' +
            '<i class="duceapp_font f17 vm3"></i> 20190917</span><strong class="status"><em class="succ">已通过</em></strong></div>' +
            '<dl class="cl"><dt><cite style="color:"><i class="duceapp_font f15"></i> 积分 <span class="ff9">- 100</span></cite></dt>' +
            '<dd>￥0.10</dd></dl><dl class="cl mt6"><dt class="status f13 ff9" style="line-height:26px;"><i class="duceapp_font f15 vm3"></i> ' +
            '2019-08-05 16:40:27</dt></dl></a></li>';


        //数据内容加工显示
        function appendToHTML(items, count) {
            if (items.length > 0 && items.length > count) {
                append_for(items, count);
                $('#page-ul').append('<li class = "bga bh_e f14"><a href = "">' +
                    '<div class = "cl"> <strong class = "status ffr" style = "float: left;"></strong>' +
                    ' <span class = "status"><em style = "color: #8b8b8b;"></em></span></div><dl class = "cl" style="text-align: center; font-size: 14px; color: #a6a6a6;"><p>' +
                    '往上滑动获取更多数据</p><dt></dt></dl><dl class = "cl mt6"><dd>' +
                    '<span class = "status f13 ff9"></span>' +
                    '</dd></dl></a></li>');
            } else if (count >= items.length) {
                append_for(items, count);
                $('#page-ul').append(li_html);
            } else {
                $('#page-ul').append(li_html);
            }

            function append_for(items, count) {
                $('#page-ul').html('');
                try {
                    var statusHtml;
                    for (var i = 0; i < count; i++) {
                        var info = items[i];
                        if (info.stauts == 1) {
                            statusHtml = '<em class="succ">已通过</em>'
                        } else {
                            statusHtml = '<em class="status">未通过</em>'
                        }

                        $('#page-ul').append('<li class="bga bh_e f14"><a href="#"><div class="cl"><span class="f13 ff9" style="white-space:nowarp">' +
                            '<i class="duceapp_font f17 vm3"></i> ' + info.top_name + '</span><strong class="status">' + statusHtml + '</strong></div>' +
                            '<dl class="cl"><dt><cite style="color:"><i class="duceapp_font f15"></i> 积分 <span class="ff9">- 100</span></cite></dt>' +
                            '<dd>￥0.10</dd></dl><dl class="cl mt6"><dt class="status f13 ff9" style="line-height:26px;"><i class="duceapp_font f15 vm3"></i> ' +
                            '2019-08-05 16:40:27</dt></dl></a></li>');
                    }

                } catch (e) {
                    e.message;
                    console.log(e.message);
                }
            }
        }

        //测试数据 可删除
        function getItems() {
            var items = [];
            var no = 20190102;
            for (let i = 1; i <= 20; i++) {
                if (i % 2 == 0) {
                    var param = {
                        top_name: '订单号:-' + (no + i),
                        scope: '积分-' + (i * 100) + '',
                        time: new Date().getFullYear() + '-' + new Date().getMonth() + '-' + new Date().getDay(),
                        number: i * 10,
                        stauts: 1,
                        money: i * 0.1
                    }
                } else {
                    var param = {
                        top_name: '订单号:-' + (no + i),
                        scope: '积分-' + (i * 10) + '',
                        time: new Date().getFullYear() + '-' + new Date().getMonth() + '-' + new Date().getDay(),
                        number: i * 10,
                        stauts: 0,
                        money: i * 0.1
                    }
                }

                items.push(param);
            }
            return items;
        }

        var show_init_msg = '<em style="color: red;">最大提现额度必须大于于100</em>';
        var show_msg = '<em style="color: red;">最大提现额度必须小于120</em>';
        //    兑换事件
        $('#exchange_num').bind('input porpertychange', function () {
            var $exchange_num = $(this).val();
            var exchange_money = isNumber($exchange_num) / ratio;
            var exchange_num = isNumber($exchange_num);
            $('#exchange_money').text(exchange_money);
            try {
                exec(exchange_num);
            } catch (e) {
                console.log(e);
            }
        });

        function exec(exchange_num) {
            var $y_sum = $('#y_sum').text();//总拥有甬钻
            var $max_money = $('#max_money').text();// 最多提现数量
            var $sum_money = $('#sum_money').text();// 合计RMB
            var $min_money = $('#min_money').text();// 最低余额

            var y_sum = isNumber($y_sum);
            var max_money = isNumber($max_money);
            var sum_money = isNumber($sum_money);
            var min_money = isNumber($min_money);
            var balance = y_sum - exchange_num;

            if (exchange_num % 10 != 0) {
                $('#show_msg').html('<em style="color: red;">提现额度必须是10的倍数</em>');
                return false;
            }

            if (exchange_num % 10 == 0) {
                $('#show_msg').html('<em style="color: red;">最低提现额度必须大于2000</em>');
            }

            if (exchange_num < 2000) {
                $('#show_msg').html('<em style="color: red;">最低提现额度必须大于2000</em>');
                return false;
            } else {
                $('#show_msg').html('<em style="color: #3FDD6C;">提现后余额' + balance + '</em>');
            }

            if (exchange_num > max_money) {
                $('#show_msg').html('<em style="color: red;">提现额度必须小于' + y_sum + '</em>');
                return false;
            } else {
                $('#show_msg').html('<em style="color: #3FDD6C;">提现后余额' + balance + '</em>');
            }

            if (balance < min_money) {
                $('#show_msg').html('<em style="color: red;">最低余额不足' + min_money + '</em>');
                return false;
            } else {
                $('#show_msg').html('<em style="color: #3FDD6C;">提现后余额' + balance + '</em>');
            }
            return true;
        }

        function isNumber(value) {
            if (value == '' || value == null || value == 'undefined') {
                return 0;
            } else {
                return Number(value);
            }
        }

        //提交
        $('#cy_form').submit(function () {
            var $exchange_num = $('#exchange_num').val();
            var exchange_num = isNumber($exchange_num);
            try {
                return exec(exchange_num);
            } catch (e) {
                console.log(e);
            }
        });
    });
</script>
<div class="maskmenu" style="display:none;"></div>
</div>
<div id="mask" style="display:none;"></div>
</body>
</html>
